# Copyright (c) 2024 The Brave Authors. All rights reserved.
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at https://mozilla.org/MPL/2.0/.

import("//brave/ios/web_view/web_view_sources.gni")

config("config") {
  # TODO(crbug.com/40120082): This will only guarantee ios/web_view source files
  # are extension safe. We also need to pass this flag to all all dependencies.
  common_flags = [ "-fapplication-extension" ]
  cflags_objc = common_flags
  cflags_objcc = common_flags
  defines = [ "CWV_IMPLEMENTATION" ]
  frameworks = [
    "CoreGraphics.framework",
    "Foundation.framework",
    "MobileCoreServices.framework",
    "UIKit.framework",
  ]
}

source_set("web_view") {
  sources = ios_web_view_public_headers
  sources += [
    "internal/cwv_web_view.mm",
    "internal/cwv_web_view_configuration.mm",
    "internal/cwv_web_view_configuration_internal.h",

    "//ios/web_view/internal/cwv_back_forward_list.mm",
    "//ios/web_view/internal/cwv_back_forward_list_internal.h",
    "//ios/web_view/internal/cwv_back_forward_list_item.mm",
    "//ios/web_view/internal/cwv_back_forward_list_item_internal.h",
    "//ios/web_view/internal/cwv_download_task.mm",
    "//ios/web_view/internal/cwv_download_task_internal.h",
    "//ios/web_view/internal/cwv_favicon.mm",
    "//ios/web_view/internal/cwv_favicon_internal.h",
    "//ios/web_view/internal/cwv_find_in_page_controller.mm",
    "//ios/web_view/internal/cwv_find_in_page_controller_internal.h",
    "//ios/web_view/internal/cwv_html_element.mm",
    "//ios/web_view/internal/cwv_html_element_internal.h",
    "//ios/web_view/internal/cwv_lookalike_url_handler.mm",
    "//ios/web_view/internal/cwv_lookalike_url_handler_internal.h",
    "//ios/web_view/internal/cwv_navigation_action.mm",
    "//ios/web_view/internal/cwv_navigation_action_internal.h",
    "//ios/web_view/internal/cwv_navigation_response.mm",
    "//ios/web_view/internal/cwv_navigation_response_internal.h",
    "//ios/web_view/internal/cwv_navigation_type.mm",
    "//ios/web_view/internal/cwv_navigation_type_internal.h",
    "//ios/web_view/internal/cwv_preferences.mm",
    "//ios/web_view/internal/cwv_preferences_internal.h",
    "//ios/web_view/internal/cwv_preview_element_info.mm",
    "//ios/web_view/internal/cwv_preview_element_info_internal.h",
    "//ios/web_view/internal/cwv_ssl_error_handler.mm",
    "//ios/web_view/internal/cwv_ssl_error_handler_internal.h",
    "//ios/web_view/internal/cwv_ssl_status.mm",
    "//ios/web_view/internal/cwv_ssl_status_internal.h",
    "//ios/web_view/internal/cwv_ssl_util.h",
    "//ios/web_view/internal/cwv_ssl_util.mm",
    "//ios/web_view/internal/cwv_user_content_controller.mm",
    "//ios/web_view/internal/cwv_user_content_controller_internal.h",
    "//ios/web_view/internal/cwv_user_script.mm",
    "//ios/web_view/internal/cwv_web_view_internal.h",
    "//ios/web_view/internal/cwv_x509_certificate.mm",
    "//ios/web_view/internal/cwv_x509_certificate_internal.h",
    "//ios/web_view/internal/js_messaging/web_view_scripts_java_script_feature.h",
    "//ios/web_view/internal/js_messaging/web_view_scripts_java_script_feature.mm",
    "//ios/web_view/internal/utils/nsobject_description_utils.h",
    "//ios/web_view/internal/utils/nsobject_description_utils.mm",
    "//ios/web_view/internal/web_view_download_manager.h",
    "//ios/web_view/internal/web_view_download_manager.mm",
    "//ios/web_view/internal/web_view_java_script_dialog_presenter.h",
    "//ios/web_view/internal/web_view_java_script_dialog_presenter.mm",
    "//ios/web_view/internal/web_view_message_handler_java_script_feature.h",
    "//ios/web_view/internal/web_view_message_handler_java_script_feature.mm",
    "//ios/web_view/internal/web_view_web_state_policy_decider.h",
    "//ios/web_view/internal/web_view_web_state_policy_decider.mm",
  ]
  public_deps = [
    "//base",
    "//components/gcm_driver",
    "//components/history/core/common",
    "//components/image_fetcher/ios",
    "//components/infobars/core",
    "//components/invalidation/impl",
    "//components/keyed_service/core",
    "//components/keyed_service/ios",
    "//components/leveldb_proto",
    "//components/lookalikes/core",
    "//components/os_crypt/async/browser",
    "//components/plus_addresses/settings",
    "//components/plus_addresses/webdata",
    "//components/pref_registry",
    "//components/prefs",
    "//components/profile_metrics",
    "//components/proxy_config",
    "//components/safe_browsing/core/common:safe_browsing_prefs",
    "//components/safe_browsing/ios/browser:allow_list",
    "//components/security_interstitials/core:unsafe_resource",
    "//components/security_state/ios",
    "//components/services/patch:in_process",
    "//components/services/unzip:in_process",
    "//components/sessions:session_id",
    "//components/ssl_errors",
    "//components/strings",
    "//components/trusted_vault",
    "//components/unified_consent",
    "//components/update_client",
    "//components/update_client:common_impl",
    "//components/url_formatter",
    "//components/variations",
    "//components/variations/net",
    "//components/version_info",
    "//components/version_info:version_string",
    "//components/web_resource",
    "//components/webdata_services",
    "//ios/components/credential_provider_extension:password_spec_fetcher",
    "//ios/components/credential_provider_extension:password_util",
    "//ios/components/io_thread",
    "//ios/components/security_interstitials",
    "//ios/components/security_interstitials/https_only_mode:feature",
    "//ios/components/security_interstitials/lookalikes",
    "//ios/web/web_state/ui:wk_web_view_configuration_provider_header",
    "//ios/web/webui",


    "//ios/components/webui:provider",
    "//ios/components/webui:url_constants",
    "//ios/components/webui/sync_internals",
    "//ios/net",
    "//ios/third_party/webkit",
    "//ios/web/common",
    "//ios/web/common:user_agent",
    "//ios/web/navigation:wk_navigation_util",
    "//ios/web/public",
    "//ios/web/public/browsing_data",
    "//ios/web/public/deprecated",
    "//ios/web/public/download",
    "//ios/web/public/find_in_page",
    "//ios/web/public/init",
    "//ios/web/public/js_messaging",
    "//ios/web/public/security",
    "//ios/web/public/session:session",
    "//ios/web/public/session/proto",
    "//ios/web/public/web_view_only",
    "//ios/web/public/webui",
    "//ios/web_view/internal/js_messaging:cwv_messaging_js",
    "//net",
    "//net:extras",
    "//services/metrics/public/cpp:metrics_cpp",
    "//services/network:network_service",
    "//ui/base",
    "//ui/display",
    "//url",
  ]
  configs += [":config"]
}
